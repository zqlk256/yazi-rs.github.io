"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8303],{4069:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>c,default:()=>a,frontMatter:()=>r,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"plugins/utils","title":"Utils","description":"Learn how to use Yazi\'s Lua API.","source":"@site/docs/plugins/utils.md","sourceDirName":"plugins","slug":"/plugins/utils","permalink":"/docs/plugins/utils","draft":false,"unlisted":false,"editUrl":"https://github.com/yazi-rs/yazi-rs.github.io/edit/main/docs/plugins/utils.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"description":"Learn how to use Yazi\'s Lua API."},"sidebar":"docsSidebar","previous":{"title":"Layout","permalink":"/docs/plugins/layout"},"next":{"title":"Builtins","permalink":"/docs/plugins/builtins"}}');var l=i(6070),d=i(7082);const r={sidebar_position:3,description:"Learn how to use Yazi's Lua API."},c="Utils",h={},t=[{value:"ya",id:"ya",level:2},{value:"<code>hide()</code>",id:"ya.hide",level:3},{value:"<code>file_cache(opts)</code>",id:"ya.file_cache",level:3},{value:"<code>render()</code>",id:"ya.render",level:3},{value:"<code>mgr_emit(cmd, args)</code>",id:"ya.mgr_emit",level:3},{value:"<code>image_show(url, rect)</code>",id:"ya.image_show",level:3},{value:"<code>image_precache(src, dist)</code>",id:"ya.image_precache",level:3},{value:"<code>which(opts)</code>",id:"ya.which",level:3},{value:"<code>input(opts)</code>",id:"ya.input",level:3},{value:"<code>notify(opts)</code>",id:"ya.notify",level:3},{value:"<code>dbg(msg, ...)</code>",id:"ya.dbg",level:3},{value:"<code>err(msg, ...)</code>",id:"ya.err",level:3},{value:"<code>preview_code(opts)</code>",id:"ya.preview_code",level:3},{value:"<code>preview_widgets(opts, widgets)</code>",id:"ya.preview_widgets",level:3},{value:"<code>sync(fn)</code>",id:"ya.sync",level:3},{value:"<code>target_os()</code>",id:"ya.target_os",level:3},{value:"<code>target_family()</code>",id:"ya.target_family",level:3},{value:"<code>hash(str)</code>",id:"ya.hash",level:3},{value:"<code>quote(str)</code>",id:"ya.quote",level:3},{value:"<code>truncate(text, opts)</code>",id:"ya.truncate",level:3},{value:"<code>clipboard(text)</code>",id:"ya.clipboard",level:3},{value:"<code>time()</code>",id:"ya.time",level:3},{value:"<code>sleep(secs)</code>",id:"ya.sleep",level:3},{value:"<code>uid()</code>",id:"ya.uid",level:3},{value:"<code>gid()</code>",id:"ya.gid",level:3},{value:"<code>user_name(uid)</code>",id:"ya.user_name",level:3},{value:"<code>group_name(gid)</code>",id:"ya.group_name",level:3},{value:"<code>host_name()</code>",id:"ya.host_name",level:3},{value:"ps",id:"ps",level:2},{value:"<code>pub(kind, value)</code>",id:"ps.pub",level:3},{value:"<code>pub_to(receiver, kind, value)</code>",id:"ps.pub_to",level:3},{value:"<code>sub(kind, callback)</code>",id:"ps.sub",level:3},{value:"<code>sub_remote(kind, callback)</code>",id:"ps.sub_remote",level:3},{value:"<code>unsub(kind)</code>",id:"ps.unsub",level:3},{value:"<code>unsub_remote(kind)</code>",id:"ps.unsub_remote",level:3},{value:"fs",id:"fs",level:2},{value:"<code>cwd()</code>",id:"fs.cwd",level:3},{value:"<code>cha(url, follow)</code>",id:"fs.cha",level:3},{value:"<code>write(url, data)</code>",id:"fs.write",level:3},{value:"<code>create(type, url)</code>",id:"fs.create",level:3},{value:"<code>remove(type, url)</code>",id:"fs.remove",level:3},{value:"<code>read_dir(url, options)</code>",id:"fs.read_dir",level:3},{value:"<code>unique_name(url)</code>",id:"unique_nameurl",level:3},{value:"Command",id:"command",level:2},{value:"<code>arg(arg)</code>",id:"Command.arg",level:3},{value:"<code>args(args)</code>",id:"Command.args",level:3},{value:"<code>cwd(dir)</code>",id:"Command.cwd",level:3},{value:"<code>env(key, value)</code>",id:"Command.env",level:3},{value:"<code>stdin(cfg)</code>",id:"Command.stdin",level:3},{value:"<code>stdout(cfg)</code>",id:"Command.stdout",level:3},{value:"<code>stderr(cfg)</code>",id:"Command.stderr",level:3},{value:"<code>spawn()</code>",id:"Command.spawn",level:3},{value:"<code>output()</code>",id:"Command.output",level:3},{value:"<code>status()</code>",id:"Command.status",level:3},{value:"Child",id:"child",level:2},{value:"<code>read(len)</code>",id:"Child.read",level:3},{value:"<code>read_line()</code>",id:"Child.read_line",level:3},{value:"<code>read_line_with(opts)</code>",id:"Child.read_line_with",level:3},{value:"<code>write_all(src)</code>",id:"Child.write_all",level:3},{value:"<code>flush()</code>",id:"Child.flush",level:3},{value:"<code>wait()</code>",id:"Child.wait",level:3},{value:"<code>wait_with_output()</code>",id:"Child.wait_with_output",level:3},{value:"<code>start_kill()</code>",id:"Child.start_kill",level:3},{value:"<code>take_stdin()</code>",id:"Child.take_stdin",level:3},{value:"<code>take_stdout()</code>",id:"Child.take_stdout",level:3},{value:"<code>take_stderr()</code>",id:"Child.take_stderr",level:3},{value:"Output",id:"output",level:2},{value:"Status",id:"status",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"utils",children:"Utils"})}),"\n",(0,l.jsx)(n.h2,{id:"ya",children:"ya"}),"\n",(0,l.jsx)(n.h3,{id:"ya.hide",children:(0,l.jsx)(n.code,{children:"hide()"})}),"\n",(0,l.jsx)(n.p,{children:"Hide Yazi to the secondary screen by returning to the terminal, completely controlled by the requested plugin."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local permit = ya.hide()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["This method returns a ",(0,l.jsx)(n.code,{children:"permit"})," for this resource. When it's necessary to restore the TUI display, call its ",(0,l.jsx)(n.code,{children:"drop()"})," method:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"permit:drop()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Note that since there's always only one available terminal control resource, ",(0,l.jsx)(n.code,{children:"ya.hide()"})," cannot be called again before the previous ",(0,l.jsx)(n.code,{children:"permit"})," is dropped, otherwise an error will be thrown, effectively avoiding deadlocks."]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.file_cache",children:(0,l.jsx)(n.code,{children:"file_cache(opts)"})}),"\n",(0,l.jsxs)(n.p,{children:["Calculate the cached ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," corresponding to the given file:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the cache, which is a table:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"file"}),": The ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.file",children:"File"})," to be cached."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"skip"}),": The number of units to skip. It's units largely depend on your previewer, such as lines for code, and percentages for videos."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["If the file is not allowed to be cached, such as it's ignored in the user config, or the file itself is a cache, returns ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"ya.render",children:(0,l.jsx)(n.code,{children:"render()"})}),"\n",(0,l.jsx)(n.p,{children:"Re-render the UI, can only be used in the sync context, for example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local update_state = ya.sync(function(self, new_state)\n\tself.state = new_state\n\tya.render()\nend)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"ya.mgr_emit",children:(0,l.jsx)(n.code,{children:"mgr_emit(cmd, args)"})}),"\n",(0,l.jsxs)(n.p,{children:["Send a command to the ",(0,l.jsx)(n.a,{href:"/docs/configuration/keymap#manager",children:(0,l.jsx)(n.code,{children:"[manager]"})})," without waiting for the executor to execute:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cmd"}),": Required, the command name, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"args"}),": Required, the arguments of the command, which is a table with a number or string key and ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#sendable",children:"sendable values"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ya.mgr_emit("my-cmd", { "hello", 123, foo = true, bar_baz = "world" })\n\n-- Equivalent to:\n-- my-cmd "hello" "123" --foo --bar-baz="world"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["If ",(0,l.jsx)(n.code,{children:"args"})," contains userdata, it causes ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#ownership",children:"Ownership transfer"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"ya.image_show",children:(0,l.jsx)(n.code,{children:"image_show(url, rect)"})}),"\n",(0,l.jsx)(n.p,{children:"Display the given image within the specified area, and the image will downscale to fit that area automatically:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the image."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"rect"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/layout#rect",children:"Rect"})," of the area."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.image_precache",children:(0,l.jsx)(n.code,{children:"image_precache(src, dist)"})}),"\n",(0,l.jsxs)(n.p,{children:["Pre-cache the image to a specified url based on user-configured ",(0,l.jsxs)(n.a,{href:"/docs/configuration/yazi#preview",children:[(0,l.jsx)(n.code,{children:"max_width"})," and ",(0,l.jsx)(n.code,{children:"max_height"})]}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"src"}),": Required, the source ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the image."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"dist"}),": Required, the destination ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the image."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.which",children:(0,l.jsx)(n.code,{children:"which(opts)"})}),"\n",(0,l.jsx)(n.p,{children:"Prompt users with a set of available keys:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the prompt, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cands"}),": Required, the key candidates, which is a table of tables that contains the following fields:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"on"}),": Required, the key to be prompted, which is a string or a table of strings if multiple keys."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"desc"}),": Optional, the description of the key, which is a string."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"silent"}),": Optional, whether to show the UI of key indicator, which is a boolean."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cand = ya.which {\n\tcands = {\n\t\t{ on = "a" },\n\t\t{ on = "b", desc = "optional description" },\n\t\t{ on = "<C-c>", desc = "key combination" },\n\t\t{ on = { "d", "e" }, desc = "multiple keys" },\n\t},\n\t-- silent = true, -- If you don\'t want to show the UI of key indicator\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["When the user clicks a valid candidate, ",(0,l.jsx)(n.code,{children:"ya.which"})," returns the 1-based index of that ",(0,l.jsx)(n.code,{children:"cand"}),";\notherwise, it returns nil, indicating that the user has canceled the key operation."]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.input",children:(0,l.jsx)(n.code,{children:"input(opts)"})}),"\n",(0,l.jsx)(n.p,{children:"Request user input:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the input, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"title"}),": Required, the title of the input, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"}),": Optional, the default value of the input, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"position"}),": Required, the position of the input, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"1"}),": Required, the origin position of the input, which is a string accepts ",(0,l.jsx)(n.code,{children:'"top-left"'}),", ",(0,l.jsx)(n.code,{children:'"top-center"'}),", ",(0,l.jsx)(n.code,{children:'"top-right"'}),", ",(0,l.jsx)(n.code,{children:'"bottom-left"'}),", ",(0,l.jsx)(n.code,{children:'"bottom-center"'}),", ",(0,l.jsx)(n.code,{children:'"bottom-right"'}),", ",(0,l.jsx)(n.code,{children:'"center"'}),", and ",(0,l.jsx)(n.code,{children:'"hovered"'}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"x"}),": Optional, the X offset from the origin position, which is an positive or negative integer."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"y"}),": Optional, the Y offset from the origin position, which is an positive or negative integer."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"w"}),": Required, the width of the input, which is an positive integer."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"h"}),": Optional, the height of the input, which is an positive integer."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"realtime"}),": Optional, whether to report user input in real time, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"debounce"}),": Optional, the number of seconds to wait for the user to stop typing, which is a positive float. Can only be used when ",(0,l.jsx)(n.code,{children:"realtime = true"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local value, event = ya.input {\n\ttitle = "Archive name:",\n\tposition = { "top-center", y = 3, w = 40 },\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(value, event)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"}),": The user input value carried by this event, which is a string if the ",(0,l.jsx)(n.code,{children:"event"})," is non-zero; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"event"}),": The event type, which is an integer:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"0: Unknown error."}),"\n",(0,l.jsx)(n.li,{children:"1: The user has confirmed the input."}),"\n",(0,l.jsx)(n.li,{children:"2: The user has canceled the input."}),"\n",(0,l.jsxs)(n.li,{children:["3: The user has changed the input (only if ",(0,l.jsx)(n.code,{children:"realtime"})," is true)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["When ",(0,l.jsx)(n.code,{children:"realtime = true"})," specified, ",(0,l.jsx)(n.code,{children:"ya.input()"})," returns a receiver, which has a ",(0,l.jsx)(n.code,{children:"recv()"})," method that can be called multiple times to receive events."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local input = ya.input {\n\ttitle = "Input in realtime:",\n\tposition = { "center", w = 50 },\n\trealtime = true,\n}\n\nwhile true do\n\tlocal value, event = input:recv()\n\tif not value then\n\t\tbreak\n\tend\n\n\tya.dbg(value)\nend\n'})}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.notify",children:(0,l.jsx)(n.code,{children:"notify(opts)"})}),"\n",(0,l.jsx)(n.p,{children:"Send a foreground notification to the user:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the notification, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"title"}),": Required, the title of the notification, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"content"}),": Required, the content of the notification, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"timeout"}),": Required, the timeout of the notification, which is an non-negative float in seconds."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"level"}),": Optional, the level of the notification, which is a string accepts ",(0,l.jsx)(n.code,{children:'"info"'}),", ",(0,l.jsx)(n.code,{children:'"warn"'}),", and ",(0,l.jsx)(n.code,{children:'"error"'}),". Default is ",(0,l.jsx)(n.code,{children:'"info"'}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ya.notify {\n\ttitle = "Hello, World!",\n\tcontent = "This is a notification from Lua!",\n\ttimeout = 6.5,\n\t-- level = "info",\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"ya.dbg",children:(0,l.jsx)(n.code,{children:"dbg(msg, ...)"})}),"\n",(0,l.jsxs)(n.p,{children:["Append messages to ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#logging",children:"the log file"})," at the debug level:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"msg"}),": Required, the message to be logged."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ya.dbg("Hello", "World!")                       -- Multiple arguments are supported\nya.dbg({ foo = "bar", baz = 123, qux = true })  -- Any type of data is supported\n'})}),"\n",(0,l.jsx)(n.h3,{id:"ya.err",children:(0,l.jsx)(n.code,{children:"err(msg, ...)"})}),"\n",(0,l.jsxs)(n.p,{children:["Append messages to ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#logging",children:"the log file"})," at the error level:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"msg"}),": Required, the message to be logged."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ya.err("Hello", "World!")                       -- Multiple arguments are supported\nya.err({ foo = "bar", baz = 123, qux = true })  -- Any type of data is supported\n'})}),"\n",(0,l.jsx)(n.h3,{id:"ya.preview_code",children:(0,l.jsx)(n.code,{children:"preview_code(opts)"})}),"\n",(0,l.jsx)(n.p,{children:"Preview the file as code into the specified area:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the preview, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"area"}),": ",(0,l.jsx)(n.a,{href:"/docs/plugins/layout#rect",children:"Rect"})," of the available preview area."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"file"}),": ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.file",children:"File"})," to be previewed."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"mime"}),": String of the MIME type of the file."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"skip"}),": Number of units to skip. The units depend on your previewer, such as lines for code and percentages for videos."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(err, upper_bound)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": Error string if the preview fails; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"upper_bound"}),": If the preview fails and it's because exceeds the maximum upper bound, return this bound; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.preview_widgets",children:(0,l.jsx)(n.code,{children:"preview_widgets(opts, widgets)"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the preview, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"area"}),": ",(0,l.jsx)(n.a,{href:"/docs/plugins/layout#rect",children:"Rect"})," of the available preview area."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"file"}),": ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.file",children:"File"})," to be previewed."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"mime"}),": String of the MIME type of the file."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"skip"}),": Number of units to skip. The units depend on your previewer, such as lines for code and percentages for videos."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"widgets"}),": List of renderable widgets, such as ",(0,l.jsx)(n.code,{children:"{ ui.Text {...}, ui.List {...}, ... }"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.sync",children:(0,l.jsx)(n.code,{children:"sync(fn)"})}),"\n",(0,l.jsxs)(n.p,{children:["See ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#async-context",children:"Async context"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"ya.target_os",children:(0,l.jsx)(n.code,{children:"target_os()"})}),"\n",(0,l.jsx)(n.p,{children:"Returns a string describing the specific operating system in use. Some possible values:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"linux"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"macos"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"ios"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"freebsd"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"dragonfly"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"netbsd"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"openbsd"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"solaris"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"android"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"windows"'})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"ya.target_family",children:(0,l.jsx)(n.code,{children:"target_family()"})}),"\n",(0,l.jsx)(n.p,{children:"Returns the family of the operating system. Some possible values:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"unix"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"windows"'})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'"wasm"'})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"ya.hash",children:(0,l.jsx)(n.code,{children:"hash(str)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ya.hash("Hello, World!")\n'})}),"\n",(0,l.jsx)(n.p,{children:"Returns the hash of a given string:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"str"}),": Required, the string to calculate the hash for."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"It is designed to work with algorithm-independent tasks, such as generating file cache names."}),"\n",(0,l.jsxs)(n.p,{children:["The current implementation uses MD5, but it will be replaced with a faster hash algorithm, like ",(0,l.jsx)(n.a,{href:"https://github.com/Cyan4973/xxHash",children:"xxHash"}),", in the future. So, don't rely on this implementation detail."]}),"\n",(0,l.jsx)(n.h3,{id:"ya.quote",children:(0,l.jsx)(n.code,{children:"quote(str)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local handle = io.popen("ls " .. ya.quote(filename))\n'})}),"\n",(0,l.jsx)(n.p,{children:"Quote characters that may have special meaning in a shell:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"str"}),": Required, the string to be quoted."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"ya.truncate",children:(0,l.jsx)(n.code,{children:"truncate(text, opts)"})}),"\n",(0,l.jsx)(n.p,{children:"Truncate the text to the specified length and return it:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"text"}),": Required, the text to be truncated, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opts"}),": Required, the options of the truncation, which is a table:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"max"}),": Required, the maximum length of the text, which is an integer."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"rtl"}),": Optional, whether the text is right-to-left, which is a boolean."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"ya.clipboard",children:(0,l.jsx)(n.code,{children:"clipboard(text)"})}),"\n",(0,l.jsx)(n.p,{children:"Get or set the content of the system clipboard."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"text"}),": Optional, value to be set, which is a string. If not provided, the content of the clipboard will be returned."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Get contents from the clipboard\nlocal content = ya.clipboard()\n\n-- Set contents to the clipboard\nya.clipboard("new content")\n'})}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.time",children:(0,l.jsx)(n.code,{children:"time()"})}),"\n",(0,l.jsx)(n.p,{children:"Returns the current timestamp, which is a float, the integer part represents the seconds, and the decimal part represents the milliseconds."}),"\n",(0,l.jsx)(n.h3,{id:"ya.sleep",children:(0,l.jsx)(n.code,{children:"sleep(secs)"})}),"\n",(0,l.jsxs)(n.p,{children:["Waits until ",(0,l.jsx)(n.code,{children:"secs"})," has elapsed:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"secs"}),": Required, the number of seconds to sleep, which is a positive float."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"ya.sleep(0.5)  -- Sleep for 500 milliseconds\n"})}),"\n",(0,l.jsx)(n.p,{children:"This function is only available in the async context."}),"\n",(0,l.jsx)(n.h3,{id:"ya.uid",children:(0,l.jsx)(n.code,{children:"uid()"})}),"\n",(0,l.jsx)(n.p,{children:"Only available on Unix-like systems. Returns the user id of the current user, which is an integer."}),"\n",(0,l.jsx)(n.h3,{id:"ya.gid",children:(0,l.jsx)(n.code,{children:"gid()"})}),"\n",(0,l.jsx)(n.p,{children:"Only available on Unix-like systems. Returns the group id of the current user, which is an integer."}),"\n",(0,l.jsx)(n.h3,{id:"ya.user_name",children:(0,l.jsx)(n.code,{children:"user_name(uid)"})}),"\n",(0,l.jsx)(n.p,{children:"Get the name of the user:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"uid"}),": Optional, the user id of the user, which is an integer. If not set, it will use the current user's id."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns the name of the current user, which is a string if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available on Unix-like systems."}),"\n",(0,l.jsx)(n.h3,{id:"ya.group_name",children:(0,l.jsx)(n.code,{children:"group_name(gid)"})}),"\n",(0,l.jsx)(n.p,{children:"Get the name of the user group:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"gid"}),": Optional, the group id of the user, which is an integer. If not set, it will use the current user's group id."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns the name of the current group, which is a string if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"This function is only available on Unix-like systems."}),"\n",(0,l.jsx)(n.h3,{id:"ya.host_name",children:(0,l.jsx)(n.code,{children:"host_name()"})}),"\n",(0,l.jsxs)(n.p,{children:["Only available on Unix-like systems. Returns the hostname of the current machine, which is a string if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"ps",children:"ps"}),"\n",(0,l.jsxs)(n.p,{children:["Yazi's DDS (Data Distribution Service) uses a Lua-based publish-subscribe model as its carrier. That is, you can achieve cross-instance communication and state persistence through the ",(0,l.jsx)(n.code,{children:"ps"})," API. See ",(0,l.jsx)(n.a,{href:"/docs/dds",children:"DDS"})," for details."]}),"\n",(0,l.jsx)(n.p,{children:"The following functions can only be used within a sync context."}),"\n",(0,l.jsx)(n.h3,{id:"ps.pub",children:(0,l.jsx)(n.code,{children:"pub(kind, value)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ps.pub("greeting", "Hello, World!")\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Publish a message to the current instance, and all plugins subscribed through ",(0,l.jsx)(n.code,{children:"sub()"})," for this ",(0,l.jsx)(n.code,{children:"kind"})," will receive it, achieving internal communication within the instance:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kind"}),": Required, the kind of the message, which is a string of alphanumeric with dashes, and cannot be ",(0,l.jsx)(n.a,{href:"/docs/dds#kinds",children:"built-in kinds"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"}),": Required, the value of the message, which is a ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#sendable",children:"sendable value"}),". If it's a userdata, it causes ",(0,l.jsx)(n.a,{href:"/docs/plugins/overview#ownership",children:"Ownership transfer"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Since the ",(0,l.jsx)(n.code,{children:"kind"})," is used globally, to add the plugin name as the prefix is a best practice. For example, the combination of the plugin ",(0,l.jsx)(n.code,{children:"my-plugin"})," and the kind ",(0,l.jsx)(n.code,{children:"event1"})," would be ",(0,l.jsx)(n.code,{children:"my-plugin-event1"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"ps.pub_to",children:(0,l.jsx)(n.code,{children:"pub_to(receiver, kind, value)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ps.pub_to(1711957283332834, "greeting", "Hello, World!")\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Publish a message to a specific instance with ",(0,l.jsx)(n.code,{children:"receiver"})," as the ID:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["If the receiver is the current instance (local), and is subscribed to this ",(0,l.jsx)(n.code,{children:"kind"})," through ",(0,l.jsx)(n.code,{children:"sub()"}),", it will receive this message."]}),"\n",(0,l.jsxs)(n.li,{children:["If the receiver is not the current instance (remote), and is subscribed to this ",(0,l.jsx)(n.code,{children:"kind"})," through ",(0,l.jsx)(n.code,{children:"sub_remote()"}),", it will receive this message."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"With:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"receiver"}),": Required, ID of the remote instance, which is an integer; if it's ",(0,l.jsx)(n.code,{children:"0"})," then broadcasting to all remote instances."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kind"}),": The same as ",(0,l.jsx)(n.code,{children:"pub()"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"}),": The same as ",(0,l.jsx)(n.code,{children:"pub()"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"ps.sub",children:(0,l.jsx)(n.code,{children:"sub(kind, callback)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ps.sub("cd", function(body)\n\tya.dbg("New cwd", cx.active.current.cwd)\nend)\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Subscribe to local messages of ",(0,l.jsx)(n.code,{children:"kind"})," and call the ",(0,l.jsx)(n.code,{children:"callback"})," handler for it:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kind"}),": Required, the kind of the message, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"callback"}),": Required, the callback function, with a single parameter ",(0,l.jsx)(n.code,{children:"body"})," containing the content of the message."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["It runs in a sync context, so you can access app data via ",(0,l.jsx)(n.code,{children:"cx"})," for the content of interest."]}),"\n",(0,l.jsxs)(n.p,{children:["Note: No time-consuming operations should be done in the callback, and the same ",(0,l.jsx)(n.code,{children:"kind"})," from the same plugin can only be subscribed once, re-subscribing (",(0,l.jsx)(n.code,{children:"sub()"}),") before unsubscribing (",(0,l.jsx)(n.code,{children:"unsub()"}),") will throw an error."]}),"\n",(0,l.jsx)(n.h3,{id:"ps.sub_remote",children:(0,l.jsx)(n.code,{children:"sub_remote(kind, callback)"})}),"\n",(0,l.jsxs)(n.p,{children:["Similar to ",(0,l.jsx)(n.code,{children:"sub()"}),", but it subscribes to remote messages of this ",(0,l.jsx)(n.code,{children:"kind"})," instead of local."]}),"\n",(0,l.jsx)(n.h3,{id:"ps.unsub",children:(0,l.jsx)(n.code,{children:"unsub(kind)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ps.unsub("my-message")\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Unsubscribe from local messages of this ",(0,l.jsx)(n.code,{children:"kind"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kind"}),": Required, the kind of the message, which is a string."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"ps.unsub_remote",children:(0,l.jsx)(n.code,{children:"unsub_remote(kind)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'ps.unsub_remote("my-message")\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Unsubscribe from remote messages of this ",(0,l.jsx)(n.code,{children:"kind"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kind"}),": Required, the kind of the message, which is a string."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"fs",children:"fs"}),"\n",(0,l.jsx)(n.p,{children:"The following functions can only be used within an async context."}),"\n",(0,l.jsx)(n.h3,{id:"fs.cwd",children:(0,l.jsx)(n.code,{children:"cwd()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local url, err = fs.cwd()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["This function was added to compensate for the lack of a ",(0,l.jsx)(n.a,{href:"https://man7.org/linux/man-pages/man3/getcwd.3.html",children:(0,l.jsx)(n.code,{children:"getcwd"})})," in Lua; it is used to retrieve the directory of the last ",(0,l.jsx)(n.a,{href:"https://man7.org/linux/man-pages/man2/chdir.2.html",children:(0,l.jsx)(n.code,{children:"chdir"})})," call."]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(url, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": The ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the current working directory if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["You probably will never need it, and more likely, you'll need ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#app-data.tab-folder",children:(0,l.jsx)(n.code,{children:"cx.active.current.cwd"})}),", which is the current directory where the user is working."]}),"\n",(0,l.jsxs)(n.p,{children:["Specifically, when the user changes the directory, ",(0,l.jsx)(n.code,{children:"cx.active.current.cwd"})," gets updated immediately, while synchronizing this update with the filesystem via ",(0,l.jsx)(n.code,{children:"chdir"})," involves I/O operations, such as checking if the directory is valid."]}),"\n",(0,l.jsx)(n.p,{children:"So, there may be some delay, which is particularly noticeable on slow devices. For example, when an HDD wakes up from sleep, it typically takes 3~4 seconds."}),"\n",(0,l.jsx)(n.p,{children:"It is useful if you just need a valid directory as the CWD of a process to start some work that doesn't depend on the CWD."}),"\n",(0,l.jsx)(n.h3,{id:"fs.cha",children:(0,l.jsx)(n.code,{children:"cha(url, follow)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local cha, err = fs.cha(url)\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Get the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.cha",children:"Cha"})," of the specified file:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the file."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"follow"}),": Optional, whether to follow the symbolic link, which is a boolean."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(cha, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cha"}),": The ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.cha",children:"Cha"})," of the file if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"fs.write",children:(0,l.jsx)(n.code,{children:"write(url, data)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local ok, err = fs.write(url, "hello world")\n'})}),"\n",(0,l.jsx)(n.p,{children:"Write data to the specified file:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the file."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"data"}),": Required, the data to be written, which is a string."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(ok, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ok"}),": Whether the operation is successful, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"fs.create",children:(0,l.jsx)(n.code,{children:"create(type, url)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local ok, err = fs.create("dir_all", Url("/tmp/test/nest/nested"))\n'})}),"\n",(0,l.jsx)(n.p,{children:"Create the specified file(s) in the filesystem."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"type"}),": Required, the type of creation, which can be:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'"dir"'}),": Creates a new, empty directory."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'"dir_all"'}),": Recursively create a directory and all of its parents if they are missing."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the target."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(ok, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ok"}),": Whether the operation is successful, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"fs.remove",children:(0,l.jsx)(n.code,{children:"remove(type, url)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local ok, err = fs.remove("file", Url("/tmp/test.txt"))\n'})}),"\n",(0,l.jsx)(n.p,{children:"Remove the specified file(s) from the filesystem:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"type"}),": Required, the type of removal, which can be:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'"file"'}),": Removes a file from the filesystem."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'"dir"'}),": Removes an existing, empty directory."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'"dir_all"'}),": Removes a directory at this url, after removing all its contents. Use carefully!"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'"dir_clean"'}),": Remove all empty directories under it, and if the directory itself is empty afterward, remove it as well."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the target."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(ok, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ok"}),": Whether the operation is successful, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"fs.read_dir",children:(0,l.jsx)(n.code,{children:"read_dir(url, options)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local files, err = fs.read_dir("url", { limit = 10 })\n'})}),"\n",(0,l.jsx)(n.p,{children:"Reads the contents of a directory:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the directory."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"options"}),": Optional, a table with the following options:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"glob"}),": A glob pattern to filter files out if provided."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"limit"}),": The maximum number of files to read, which is an integer, defaults to unlimited."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"resolve"}),": Whether to resolve symbolic links, defaults to ",(0,l.jsx)(n.code,{children:"false"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(files, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"files"}),": A table of ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.file",children:"File"})," if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"unique_nameurl",children:(0,l.jsx)(n.code,{children:"unique_name(url)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local url, err = fs.unique_name(Url("/tmp/test.txt"))\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Get a unique name from the given ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," to ensure it's unique in the filesystem:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": Required, the ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the path to get a unique name."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"(url, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"url"}),": The unique ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.url",children:"Url"})," of the given path if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["If the file already exists, the function will append ",(0,l.jsx)(n.code,{children:"_n"})," to the filename, where ",(0,l.jsx)(n.code,{children:"n"})," is a number, and keep incrementing it until it finds the first available name."]}),"\n",(0,l.jsx)(n.h2,{id:"command",children:"Command"}),"\n",(0,l.jsx)(n.p,{children:"You can invoke external programs through:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local child, err = Command("ls")\n\t:args({ "-a", "-l" })\n\t:stdout(Command.PIPED)\n\t:spawn()\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Compared to Lua's ",(0,l.jsx)(n.code,{children:"os.execute"}),", it provides many comprehensive and convenient methods, and the entire process is async."]}),"\n",(0,l.jsx)(n.p,{children:"It takes better advantage of the benefits of concurrent scheduling. However, it can only be used in async contexts, such as preloaders, previewers, and async functional plugins."}),"\n",(0,l.jsx)(n.h3,{id:"Command.arg",children:(0,l.jsx)(n.code,{children:"arg(arg)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):arg("-a"):arg("-l")\n'})}),"\n",(0,l.jsx)(n.p,{children:"Append an argument to the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"arg"}),": Required, the argument to be appended, which is a string."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.args",children:(0,l.jsx)(n.code,{children:"args(args)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):args({ "-a", "-l" }):args({ "-h" })\n'})}),"\n",(0,l.jsx)(n.p,{children:"Append multiple arguments to the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"args"}),": Required, the arguments to be appended, which is a table of strings."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.cwd",children:(0,l.jsx)(n.code,{children:"cwd(dir)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):cwd("/root")\n'})}),"\n",(0,l.jsx)(n.p,{children:"Set the current working directory of the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"dir"}),": Required, the directory of the command, which is a string."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.env",children:(0,l.jsx)(n.code,{children:"env(key, value)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):env("PATH", "/bin"):env("HOME", "/home")\n'})}),"\n",(0,l.jsx)(n.p,{children:"Append an environment variable to the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"key"}),": Required, the key of the environment variable, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"}),": Required, the value of the environment variable, which is a string."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.stdin",children:(0,l.jsx)(n.code,{children:"stdin(cfg)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):stdin(Command.PIPED)\n'})}),"\n",(0,l.jsx)(n.p,{children:"Set the stdin of the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cfg"}),": Required, the configuration of the stdin, accepts the following values:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.PIPED"}),": Pipe the stdin."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.NULL"}),": Discard the stdin."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.INHERIT"}),": Inherit the stdin."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["If not set, the stdin will be null. Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.stdout",children:(0,l.jsx)(n.code,{children:"stdout(cfg)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):stdout(Command.PIPED)\n'})}),"\n",(0,l.jsx)(n.p,{children:"Set the stdout of the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cfg"}),": Required, the configuration of the stdout, accepts the following values:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.PIPED"}),": Pipe the stdout."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.NULL"}),": Discard the stdout."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.INHERIT"}),": Inherit the stdout."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["If not set, the stdout will be null. Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.stderr",children:(0,l.jsx)(n.code,{children:"stderr(cfg)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local cmd = Command("ls"):stderr(Command.PIPED)\n'})}),"\n",(0,l.jsx)(n.p,{children:"Set the stderr of the command:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cfg"}),": Required, the configuration of the stderr, accepts the following values:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.PIPED"}),": Pipe the stderr."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.NULL"}),": Discard the stderr."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Command.INHERIT"}),": Inherit the stderr."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["If not set, the stderr will be null. Returns ",(0,l.jsx)(n.code,{children:"self"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Command.spawn",children:(0,l.jsx)(n.code,{children:"spawn()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local child, err = Command("ls"):spawn()\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Spawn the command, returns ",(0,l.jsx)(n.code,{children:"(child, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"child"}),": The ",(0,l.jsx)(n.a,{href:"#child",children:"Child"})," of the command if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Command.output",children:(0,l.jsx)(n.code,{children:"output()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local output, err = Command("ls"):output()\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Spawn the command and wait for it to finish, returns ",(0,l.jsx)(n.code,{children:"(output, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"output"}),": The ",(0,l.jsx)(n.a,{href:"#output",children:"Output"})," of the command if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Command.status",children:(0,l.jsx)(n.code,{children:"status()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local status, err = Command("ls"):status()\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Executes the command as a child process, waiting for it to finish and collecting its exit status. Returns ",(0,l.jsx)(n.code,{children:"(status, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"status"}),": The ",(0,l.jsx)(n.a,{href:"#status",children:"Status"})," of the child process if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"child",children:"Child"}),"\n",(0,l.jsxs)(n.p,{children:["This object is created by ",(0,l.jsx)(n.a,{href:"#Command.spawn",children:(0,l.jsx)(n.code,{children:"Command:spawn()"})})," and represents a running child process."]}),"\n",(0,l.jsx)(n.p,{children:"You can access the runtime data of this process through its proprietary methods."}),"\n",(0,l.jsx)(n.h3,{id:"Child.read",children:(0,l.jsx)(n.code,{children:"read(len)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local data, event = child:read(1024)\n"})}),"\n",(0,l.jsxs)(n.p,{children:['Let\'s say "available data source" refers to ',(0,l.jsx)(n.code,{children:"stdout"})," or ",(0,l.jsx)(n.code,{children:"stderr"})," that has been set with ",(0,l.jsx)(n.code,{children:"Command.PIPED"}),", or them both."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"read()"})," reads data from the available data source alternately, and the ",(0,l.jsx)(n.code,{children:"event"})," indicates the source of the data:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"The data comes from stdout if event is 0."}),"\n",(0,l.jsx)(n.li,{children:"The data comes from stderr if event is 1."}),"\n",(0,l.jsx)(n.li,{children:"There's no data to read from both stdout and stderr, if event is 2."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Child.read_line",children:(0,l.jsx)(n.code,{children:"read_line()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local line, event = child:read_line()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Similar to ",(0,l.jsx)(n.a,{href:"#Child.read",children:(0,l.jsx)(n.code,{children:"read()"})}),", but it reads data line by line."]}),"\n",(0,l.jsx)(n.h3,{id:"Child.read_line_with",children:(0,l.jsx)(n.code,{children:"read_line_with(opts)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local line, event = child:read_line_with { timeout = 500 }\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Similar to ",(0,l.jsx)(n.a,{href:"#Child.read_line",children:(0,l.jsx)(n.code,{children:"read_line()"})}),", but it accepts a table of options:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"timeout"}),": Required, timeout in milliseconds, which is an integer"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"And includes the following additional events:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Timeout if event is 3."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Child.write_all",children:(0,l.jsx)(n.code,{children:"write_all(src)"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local ok, err = child:write_all(src)\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Writes all bytes from the string ",(0,l.jsx)(n.code,{children:"src"})," to the stdin of the child process, returns ",(0,l.jsx)(n.code,{children:"(ok, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ok"}),": Whether the operation is successful, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Please ensure that the child's stdin is available when calling this method, specifically:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Command.stdin",children:(0,l.jsx)(n.code,{children:"stdin(Command.PIPED)"})})," is set."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Child.take_stdin",children:(0,l.jsx)(n.code,{children:"take_stdin()"})})," has never been called."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Otherwise, an error will be thrown."}),"\n",(0,l.jsx)(n.h3,{id:"Child.flush",children:(0,l.jsx)(n.code,{children:"flush()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local ok, err = child:flush()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Flushes any buffered data to the stdin of the child process, returns ",(0,l.jsx)(n.code,{children:"(ok, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ok"}),": Whether the operation is successful, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Please ensure that the child's stdin is available when calling this method, specifically:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Command.stdin",children:(0,l.jsx)(n.code,{children:"stdin(Command.PIPED)"})})," is set."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Child.take_stdin",children:(0,l.jsx)(n.code,{children:"take_stdin()"})})," has never been called."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Otherwise, an error will be thrown."}),"\n",(0,l.jsx)(n.h3,{id:"Child.wait",children:(0,l.jsx)(n.code,{children:"wait()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local status, err = child:wait()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Wait for the child process to finish, returns ",(0,l.jsx)(n.code,{children:"(status, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"status"}),": The ",(0,l.jsx)(n.a,{href:"#status",children:"Status"})," of the child process if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Child.wait_with_output",children:(0,l.jsx)(n.code,{children:"wait_with_output()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local output, err = child:wait_with_output()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Wait for the child process to finish and get the output, returns ",(0,l.jsx)(n.code,{children:"(output, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"output"}),": The ",(0,l.jsx)(n.a,{href:"#output",children:"Output"})," of the child process if successful; otherwise, ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Child.start_kill",children:(0,l.jsx)(n.code,{children:"start_kill()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local ok, err = child:start_kill()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Send a SIGTERM signal to the child process, returns ",(0,l.jsx)(n.code,{children:"(ok, err)"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ok"}),": Whether the operation is successful, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"err"}),": The error if the operation is failed, which is an ",(0,l.jsx)(n.a,{href:"/docs/plugins/types#shared.error",children:"Error"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"Child.take_stdin",children:(0,l.jsx)(n.code,{children:"take_stdin()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local stdin = child:take_stdin()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Take and return the stdin stream of the child process, which can only be called once and is only applicable to processes with ",(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Command.stdin",children:(0,l.jsx)(n.code,{children:"stdin(Command.PIPED)"})})," set; otherwise, it returns ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"Child.take_stdout",children:(0,l.jsx)(n.code,{children:"take_stdout()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local stderr = child:take_stdout()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Take and return the stdout stream of the child process, which can only be called once and is only applicable to processes with ",(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Command.stdin",children:(0,l.jsx)(n.code,{children:"stdout(Command.PIPED)"})})," set; otherwise, it returns ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"This is useful when redirecting stdout to another process's stdin:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local echo = Command("echo"):arg("Hello"):stdout(Command.PIPED):spawn()\n\nlocal rev = Command("rev"):stdin(echo:take_stdout()):stdout(Command.PIPED):output()\n\nya.dbg(rev.stdout) -- "olleH\\n"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"Child.take_stderr",children:(0,l.jsx)(n.code,{children:"take_stderr()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local stderr = child:take_stderr()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Take and return the stderr stream of the child process, which can only be called once and is only applicable to processes with ",(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Command.stdin",children:(0,l.jsx)(n.code,{children:"stderr(Command.PIPED)"})})," set; otherwise, it returns ",(0,l.jsx)(n.code,{children:"nil"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["See ",(0,l.jsx)(n.a,{href:"/docs/plugins/utils#Child.take_stdout",children:(0,l.jsx)(n.code,{children:"take_stdout()"})})," for an example."]}),"\n",(0,l.jsx)(n.h2,{id:"output",children:"Output"}),"\n",(0,l.jsx)(n.p,{children:"Properties:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"status"}),": The ",(0,l.jsx)(n.a,{href:"#status",children:"Status"})," of the child process."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"stdout"}),": The stdout of the child process, which is a string."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"stderr"}),": The stderr of the child process, which is a string."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"status",children:"Status"}),"\n",(0,l.jsxs)(n.p,{children:["This object represents the exit status of a child process, and it is created by ",(0,l.jsx)(n.a,{href:"#Child.wait",children:(0,l.jsx)(n.code,{children:"wait()"})}),", or ",(0,l.jsx)(n.a,{href:"#Command.output",children:(0,l.jsx)(n.code,{children:"output()"})}),"."]}),"\n",(0,l.jsx)(n.p,{children:"Properties:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"success"}),": whether the child process exited successfully, which is a boolean."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"code"}),": the exit code of the child process, which is an integer if any."]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},7082:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var s=i(758);const l={},d=s.createContext(l);function r(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);